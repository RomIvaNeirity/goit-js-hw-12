{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nexport default getImagesByQuery;\n/* let page = 10 */\n\nasync function getImagesByQuery(query, page = 1) {\n  const resp = await axios({\n    method: 'get',\n    url: 'https://pixabay.com/api/',\n    params: {\n      key: '28573378-d6ea96aa58230c7b9cb77205d',\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: \"15\",\n      page\n      \n    },\n  });\n  return resp.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\n\nexport function createGallery(images) {\n  let list = '';\n  images\n    .map(image => {\n      list =\n        list +\n        `<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${image.largeImageURL}\">\n    <img\n      class=\"gallery-image\"\n      src=\"${image.webformatURL}\"\n      alt=\"${image.tags}\"\n      data-user=\"Uploaded by user: ${image.user}\"\n    />\n  </a>\n  <ul class=\"image-attribute-list\">\n  <li class=\"image-attribute-list-item\">\n  <p>Likes</p>\n  <p>${image.likes}</p>\n  </li>\n  <li class=\"image-attribute-list-item\">\n  <p>Views</p>\n  <p>${image.views}</p>\n  </li>\n  <li class=\"image-attribute-list-item\">\n  <p>Comments</p>\n  <p>${image.comments}</p>\n  </li>\n  <li class=\"image-attribute-list-item\">\n  <p>Downloads</p>\n  <p>${image.downloads}</p>\n  </li>\n  </ul> \n</li>`;\n    })\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', list);\n  modal.refresh();\n}\n\nconst modal = new SimpleLightbox('.gallery-link', {\n  captions: true,\n  captionsData: 'data-user',\n  captionDelay: 250,\n});\n\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\n\nconst loader = document.querySelector(\".loader\");\n\nexport function showLoader() {\n  loader.style.display = 'block';\n}\n\nexport function hideLoader() {\n  loader.style.display = 'none';\n}\n","hideLoader();\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport getImagesByQuery from './js/pixabay-api';\nimport {\n  createGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n} from './js/render-functions';\n\nlet query;\nlet page = 1;\nconst search = document.querySelector('form');\nsearch.addEventListener('submit', clickSearch);\nconst loadBtn = document.querySelector(\".load-more-button\");\nloadBtn.addEventListener(\"click\", loadMore);\n\nasync function clickSearch(event) {\n  event.preventDefault();\n  clearGallery();\n  loadBtn.classList.add(\"load-more-button-hidden\");\n iziToast.destroy();\n  query = event.target.elements['search-text'].value.trim();\n  if (query.trim() === '') {\n    iziToast.show({\n      message: 'Please, type some text',\n    });\n    search.reset();\n    return;\n  }\n\n  showLoader();\n\n  try {\n    const data = await getImagesByQuery(query, page);\n    if (!data.hits.length) {\n      hideLoader();\n      iziToast.show({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      }); loadBtn.classList.add(\"load-more-button-hidden\");\n      return;\n    }\n    \n    createGallery(data.hits);\n    hideLoader();\n    \n    const totalPages = Math.ceil(data.totalHits / 15);\n    if (page >= totalPages) {\n      loadBtn.classList.add(\"load-more-button-hidden\");\n      iziToast.show({timeout: 0,\n        position: 'bottomCenter',\n        message:\n      \"We're sorry, but you've reached the end of search results.\"\n      });\n  } else {loadBtn.classList.remove(\"load-more-button-hidden\")}\n\n  } catch (error) {\n    handleAxiosError(error);\n  } finally {\n    hideLoader();\n    search.reset();    \n  }\n}\n\nasync function loadMore() {\n  \n  page += 1;\n  showLoader();\n  \n  try {\n    const data = await getImagesByQuery(query, page);\n    createGallery(data.hits);\n    loadBtn.classList.add(\"load-more-button-hidden\");\n    hideLoader();\n\n    const galleryCad = document.querySelector(\"li\");\n    const domRect = galleryCad.getBoundingClientRect();\n    window.scrollBy({ top: (domRect.height * 2), behavior: \"smooth\" })\n\n    const totalPages = Math.ceil(data.totalHits / 15);\n    if (page >= totalPages) {\n      loadBtn.classList.add(\"load-more-button-hidden\");\n      iziToast.show({timeout: 0,\n        position: 'bottomCenter',\n        message:\n      \"We're sorry, but you've reached the end of search results.\"\n      });\n    } else { loadBtn.classList.remove(\"load-more-button-hidden\") }\n\n  } catch (error) {\n    handleAxiosError(error);\n  } finally {\n    hideLoader();\n    search.reset();    \n  }\n}\n\nfunction handleAxiosError(error) {\n  let message = '';\n  if (error.response) {\n    message = `Server error: ${error.response.status}`;\n  } else if (error.request) {\n    message = 'No response from server. Please try again later.';\n  } else {\n    message = `Request error: ${error.message}`;\n  }\n  console.error('Axios error:', error);\n  iziToast.show({ message, backgroundColor: 'red' });\n}\n\niziToast.settings({\n  position: 'center',\n  backgroundColor: 'magenta',\n  messageSize: '20',\n  timeout: 3000,\n});\n"],"names":["getImagesByQuery","query","page","axios","gallery","createGallery","images","list","image","modal","SimpleLightbox","clearGallery","loader","showLoader","hideLoader","search","clickSearch","loadBtn","loadMore","event","iziToast","data","totalPages","error","handleAxiosError","domRect","message"],"mappings":"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"}